<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Priors</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Priors</h1>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>The main focus here is to explain the default priors used in
<code>bayesnec</code> and to showcase how the user can interrogate the
priors used in a <code>bayesec</code> model and alternatively specify
their own priors, should they wish to. This might be needed depending on
the model and the data because <code>bayesnec</code> tries to find
reasonable and yet only weakly informative priors for the model
parameters by default. First we describe the default priors used in
<code>bayesnec</code> and then follow up with a demonstration of how the
user can specify priors in multiple ways for objects of class
<code>bayesnecfit</code> and <code>bayesmanecfit</code>.</p>
</div>
<div id="default-priors-in-bayesnec" class="section level2">
<h2>Default priors in <code>bayesnec</code></h2>
<p>The default priors used in <code>bayesnec</code> can generally be
considered “weakly informative”. They are constructed for each parameter
of each model being fitted based on the characteristics of either the
input response and predictor data, depending on which is relevant to the
specific parameter scaling. In the case of parameters that scale with
the response, priors are constructed based on the relevant link scaling,
whether that be identity or the default (or user specific) link function
for a specific distribution. The priors are constructed by
<code>bnec</code> internally based on the chosen model, the distribution
(including the relevant link function), the predictor and the
response.</p>
<div id="priors-for-response-scaled-parameters" class="section level3">
<h3>Priors for response-scaled parameters</h3>
<p>Only the parameters <strong>top</strong> and <strong>bot</strong>
scale specifically with the response. For Gaussian-distributed response
data (or any response data for which the link ensures valid values of
the response can take from <code>+Inf</code> to <code>-Inf</code>,
including <code>log</code> and <code>logit</code>) priors are
<code>normal</code> with a standard deviation of <code>2.5</code> times
the standard deivation of the response data, and a mean set at the
90<sup>th</sup> and 10<sup>th</sup> quantiles for <strong>top</strong>
and <strong>bot</strong> respectively. For Poisson-, Negative Binomial-
and Gamma-distributed data the response is bounded by <code>0</code> and
thus priors are <code>Gamma</code>, with a mean scaled to correspond to
the 75<sup>th</sup> and 25<sup>th</sup> quantiles for
<strong>top</strong> and <strong>bot</strong> respectively. The mean is
linked mathematically to the shape (<em>s</em>) and rate parameters
(<em>r</em>) by the equation <span class="math inline">\(mean = s \times
(1/r)\)</span> with the Gamma shape parameter set at 2. For the
Binomial, Beta, and Beta Binomial families estimates for
<strong>top</strong> and <strong>bot</strong> must necessarily be
constrained between <code>0</code> and <code>1</code> when modelled on
the <code>&quot;identity&quot;</code> link (the default in <code>bayesnec</code>).
Because of this constraint there is no need to adjust scaling based on
the response. <code>bayesnec</code> uses <code>beta(5, 2)</code> and
<code>beta(2, 5)</code> priors to provide a broad density centred across
the upper and lower <code>0</code> to <code>1</code> range for the
<strong>top</strong> and <strong>bot</strong> parameters,
respectively.</p>
</div>
<div id="priors-for-predictor-scaled-parameters" class="section level3">
<h3>Priors for predictor-scaled parameters</h3>
<p>The parameters <strong>nec</strong> and <strong>ec50</strong> scale
with respect to the predictor because both of these are parameters in
concentration-response curves the are estimated in units of
concentration. To stabilise model fitting the <strong>nec</strong> and
<strong>ec50</strong> parameters are bounded to the upper and lower
observed range in the predictor, under the assumption that the range of
concentrations in the experiment were sufficient to cover the full range
of the response outcomes. The priors used reflect the characteristics of
the observed data that are used to guess the appropriate distribution.
If the predictor data are bounded to <code>0</code> and
<code>&gt;1</code>, a <code>Gamma</code> prior is used, with maximum
density (mean, see above) at the median value of the predictor, and a
shape parameter of 5. If the predictor data are bounded to
<code>0</code> and <code>1</code> a <code>beta(2, 2)</code> prior is
used. For predictor data ranging from <code>+Inf</code> to
<code>-Inf</code> a <code>normal</code> prior is used, with a mean set
at the median of the predictor values and a standard deviation of 10
times the standard deviation of the predictor values.</p>
</div>
<div id="priors-for-other-parameters" class="section level3">
<h3>Priors for other parameters</h3>
<p>For the parameters <strong>beta</strong>, <strong>slope</strong>,
<strong>d</strong> and <strong>f</strong>, we first ensured any relevant
transformations in the model formula such that theoretical values of
<code>-Inf</code> to <code>+Inf</code> are allowable, and a
<code>normal(0, 5)</code> prior is used. For example, in the
<strong>nec3param</strong> model, <strong>beta</strong> is an
exponential decay parameter which must by definition be bounded to
<code>0</code> and <code>+Inf</code>. Calling <code>exp(beta)</code> in
the model formula ensures the exponent meets these requirements. Note
also that a mean of <code>0</code> and standard deviation of
<code>5</code> represents a relatively broad prior on the exponential
scaling. See the <strong>Model details</strong> vignette or
<code>?model(&quot;all&quot;)</code> for more information on all the models
available in <code>bayesnec</code> and their specific formulation.</p>
</div>
</div>
<div id="user-specified-priors" class="section level2">
<h2>User specified priors</h2>
<p>There may be situations were the default <code>bayesnec</code> priors
to not behave as desired, or the user wants to provide informative
priors. For example the default priors may be too informative, yielding
unreasonably tight confidence bands, although this is only likely where
there are few data. Conversely, priors may be too vague, leading to poor
model convergence, or an inability of <code>bayesnec</code> to find
appropriate starting values. Alternatively, as indicated in the example
below, the default priors may be of the wrong statistical distribution
if there was insufficient information in the provided data for
<code>bayesnec</code> to guess correctly the appropriate one to use.</p>
<p>The priors used in the default model fit can be extracted using
<code>pull_prior</code>, and a sample or plot of prior values can be
obtained from the individual <code>brms</code> model fits through the
function <code>sample_priors</code> which samples directly from the
<code>prior</code> element in the <code>brm</code> model fit. We can
also use the function <code>check_prior</code> (based on the
<code>hypothesis</code> function of <code>brms</code>) to assess how the
posterior probability density for each parameter differs from that of
the prior.</p>
<div id="bayesnecfit" class="section level3">
<h3>bayesnecfit</h3>
<p>To set specified priors, it is simplest to start by letting
<code>bnec</code> find the priors on its own, i.e. by not specifying the
<code>brm</code> argument <code>prior</code> at all.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesnec)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(nec_data)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># a single model</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>exmp_a <span class="ot">&lt;-</span> <span class="fu">bnec</span>(y <span class="sc">~</span> <span class="fu">crf</span>(x, <span class="at">model =</span> <span class="st">&quot;nec3param&quot;</span>), <span class="at">data =</span> nec_data,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">Beta</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">iter =</span> <span class="fl">1e4</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>))</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(exmp_a)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;bayesnecfit&quot; &quot;bnecfit&quot;</span></span></code></pre></div>
<p>We can view the prior and posterior probability densities of all the
parameters in the model using the function <code>check_prior</code>,
based on the <code>hypothesis</code> function of <code>brms</code>. This
can be useful to assess if priors are suitably vague, and/or if they
might be having an undesirable influence on the posterior.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_priors</span>(exmp_a)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="plot of chunk exmp3-checkpriors" width="100%" style="display: block; margin: auto;" /></p>
<p>In this case the priors seem reasonably vague, however there will be
times when it is necessary to modify these priors. The user can take
advantage of the function <code>pull_prior</code> to inspect what
<code>bnec</code> came up with on its own, and decide how best to modify
those priors to be more desirable.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pull_prior</span>(exmp_a)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                       prior class      coef group resp dpar nlpar               lb               ub</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                normal(0, 5)     b                            beta                                  </span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                normal(0, 5)     b Intercept                  beta                                  </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  gamma(5, 2.28313180499098)     b                             nec 0.03234801324009 3.22051966293556</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  gamma(5, 2.28313180499098)     b Intercept                   nec 0.03234801324009 3.22051966293556</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  beta(5, 2)     b                             top                0                1</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                  beta(5, 2)     b Intercept                   top                0                1</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           gamma(0.01, 0.01)   phi                                                0                 </span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;        source</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          user</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  (vectorized)</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          user</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  (vectorized)</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          user</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  (vectorized)</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       default</span></span></code></pre></div>
<p><code>bnec</code> chose a <code>gamma</code> prior on the
<em>NEC</em> parameter of <strong>nec3param</strong> because the
predictor <code>nec_data$x</code> is non-zero positive. However, imagine
that in theory the predictor could have had negative values, it just
happened to not have in this particular dataset. So let’s go ahead and
specify something else, say a normal with larger variance.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>my_prior <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">prior_string</span>(<span class="st">&quot;beta(5, 1)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;top&quot;</span>),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">prior_string</span>(<span class="st">&quot;normal(1.3, 2.7)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;nec&quot;</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">prior_string</span>(<span class="st">&quot;gamma(0.5, 2)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;beta&quot;</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>exmp_b <span class="ot">&lt;-</span> <span class="fu">bnec</span>(y <span class="sc">~</span> <span class="fu">crf</span>(x, <span class="at">model =</span> <span class="st">&quot;nec3param&quot;</span>), <span class="at">data =</span> nec_data,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">Beta</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>), <span class="at">prior =</span> my_prior,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">iter =</span> <span class="fl">1e4</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>))</span></code></pre></div>
<p>Two things are of note. If the user is specifying their own priors,
<code>bnec</code> requires them to specify priors for
<strong>all</strong> parameters. The <code>pull_prior</code> function
shows the priors <em>after</em> the model was fitted, but suppose the
user does not know what parameters were comprised in a particular model.
In those instances, the user can call the function
<code>show_params(model = &quot;all&quot;)</code> to inspect the parameters of
each function, or some targeted function in particular.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_params</span>(<span class="at">model =</span> <span class="st">&quot;nec3param&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; y ~ top * exp(-exp(beta) * (x - nec) * step(x - nec)) </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; top ~ 1</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta ~ 1</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; nec ~ 1</span></span></code></pre></div>
</div>
<div id="bayesmanecfit" class="section level3">
<h3>bayesmanecfit</h3>
<p>The user can also specify a named list of priors when one or more
models are being fitted to the same dataset.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>my_priors <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">nec3param =</span> <span class="fu">c</span>(<span class="fu">prior_string</span>(<span class="st">&quot;beta(5, 1)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;top&quot;</span>),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior_string</span>(<span class="st">&quot;normal(1.3, 2.7)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;nec&quot;</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior_string</span>(<span class="st">&quot;gamma(0.5, 2)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;beta&quot;</span>)),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nec4param =</span> <span class="fu">c</span>(<span class="fu">prior_string</span>(<span class="st">&quot;beta(5, 1)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;top&quot;</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior_string</span>(<span class="st">&quot;normal(1.3, 2.7)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;nec&quot;</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior_string</span>(<span class="st">&quot;gamma(0.5, 2)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;beta&quot;</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior_string</span>(<span class="st">&quot;beta(1, 5)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;bot&quot;</span>)))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>exmp_c <span class="ot">&lt;-</span> <span class="fu">bnec</span>(y <span class="sc">~</span> <span class="fu">crf</span>(x, <span class="at">model =</span> <span class="fu">c</span>(<span class="st">&quot;nec3param&quot;</span>, <span class="st">&quot;nec4param&quot;</span>)), <span class="at">data =</span> nec_data,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">Beta</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>), <span class="at">prior =</span> my_priors,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">iter =</span> <span class="fl">1e4</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>))</span></code></pre></div>
<p><code>pull_prior</code> also works for an object of class
<code>bayesmanecfit</code>, as does <code>check_priors</code> which
allows an option of passing a filename to save the prior and posterior
probability density plots to a pdf.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pull_prior</span>(exmp_c)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_priors</span>(exmp_c, <span class="at">filename =</span> <span class="st">&quot;Check_priors&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; $nec3param
#&gt;              prior class      coef group resp dpar nlpar lb ub       source
#&gt;      gamma(0.5, 2)     b                            beta               user
#&gt;      gamma(0.5, 2)     b Intercept                  beta       (vectorized)
#&gt;   normal(1.3, 2.7)     b                             nec               user
#&gt;   normal(1.3, 2.7)     b Intercept                   nec       (vectorized)
#&gt;         beta(5, 1)     b                             top               user
#&gt;         beta(5, 1)     b Intercept                   top       (vectorized)
#&gt;  gamma(0.01, 0.01)   phi                                  0         default
#&gt; 
#&gt; $nec4param
#&gt;              prior class      coef group resp dpar nlpar lb ub       source
#&gt;      gamma(0.5, 2)     b                            beta               user
#&gt;      gamma(0.5, 2)     b Intercept                  beta       (vectorized)
#&gt;         beta(1, 5)     b                             bot               user
#&gt;         beta(1, 5)     b Intercept                   bot       (vectorized)
#&gt;   normal(1.3, 2.7)     b                             nec               user
#&gt;   normal(1.3, 2.7)     b Intercept                   nec       (vectorized)
#&gt;         beta(5, 1)     b                             top               user
#&gt;         beta(5, 1)     b Intercept                   top       (vectorized)
#&gt;  gamma(0.01, 0.01)   phi                                  0         default</code></pre>
<p>The user can also specify priors for one model only out of the entire
set, <code>bayesnec</code> will return a message stating that it is
searching for priors on its own when they are either ill-formed
(e.g. incomplete or have a typo), or the user simply decided not to
specify priors for a particular model, e.g.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>my_priors <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">nec3param =</span> <span class="fu">c</span>(<span class="fu">prior_string</span>(<span class="st">&quot;beta(5, 1)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;top&quot;</span>),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior_string</span>(<span class="st">&quot;normal(1.3, 2.7)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;nec&quot;</span>),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior_string</span>(<span class="st">&quot;gamma(0.5, 2)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;beta&quot;</span>)),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nec4param =</span> <span class="fu">c</span>(<span class="fu">prior_string</span>(<span class="st">&quot;beta(5, 1)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;top&quot;</span>),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior_string</span>(<span class="st">&quot;normal(1.3, 2.7)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;nec&quot;</span>),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior_string</span>(<span class="st">&quot;gamma(0.5, 2)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;beta&quot;</span>),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">prior_string</span>(<span class="st">&quot;beta(1, 5)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;bot&quot;</span>)))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>exmp_d <span class="ot">&lt;-</span> <span class="fu">bnec</span>(y <span class="sc">~</span> <span class="fu">crf</span>(x, <span class="at">model =</span> <span class="fu">c</span>(<span class="st">&quot;nec3param&quot;</span>, <span class="st">&quot;nec4param&quot;</span>)), <span class="at">data =</span> nec_data,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">Beta</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>), <span class="at">prior =</span> my_priors[<span class="dv">1</span>],</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">iter =</span> <span class="fl">1e4</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>))</span></code></pre></div>
<p><code>prior = my_priors[[1]]</code> would also have worked because
the argument priors can either take a <code>brmsprior</code> object
directly, or a named list containing model-specific
<code>brmsprior</code> objects.</p>
<p>Finally the user can also extend an existing
<code>bayesmanecfit</code> object with the function <code>amend</code>,
also by specifying custom-built <code>priors</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>necsigm_priors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">prior_string</span>(<span class="st">&quot;beta(5, 1)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;top&quot;</span>),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">prior_string</span>(<span class="st">&quot;gamma(2, 6.5)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;beta&quot;</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">prior_string</span>(<span class="st">&quot;normal(1.3, 2.7)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;nec&quot;</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">prior_string</span>(<span class="st">&quot;normal(0, 2)&quot;</span>, <span class="at">nlpar =</span> <span class="st">&quot;d&quot;</span>))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>exmp_e <span class="ot">&lt;-</span> <span class="fu">amend</span>(exmp_d, <span class="at">add =</span> <span class="st">&quot;necsigm&quot;</span>, <span class="at">priors =</span> necsigm_priors)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
