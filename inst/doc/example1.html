<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Single model usage</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Single model usage</h1>



<div id="bayesnec" class="section level1">
<h1><code>bayesnec</code></h1>
<p>The <code>bayesnec</code> is an R package to fit concentration(dose)
— response curves to toxicity data, and derive No-Effect-Concentration
(<em>NEC</em>), No-Significant-Effect-Concentration (<em>NSEC</em>), and
Effect-Concentration (of specified percentage “x”, <em>ECx</em>)
thresholds from non-linear models fitted using Bayesian Hamiltonian
Monte Carlo (HMC) via <code>brms</code> <span class="citation">(Paul
Christian Bürkner 2017; Paul-Christian Bürkner 2018)</span> and
<code>stan</code>. The package is an adaptation and extension of an
initial package <code>jagsNEC</code> <span class="citation">(Fisher,
Ricardo, and Fox 2020)</span> which was based on the <code>R2jags</code>
package <span class="citation">(Su and Yajima 2015)</span> and
<code>jags</code> <span class="citation">(Plummer 2003)</span>.</p>
</div>
<div id="background" class="section level1">
<h1>Background</h1>
<p>Bayesian model fitting can be difficult to automate across a broad
range of usage cases, particularly with respect to specifying valid
initial values and appropriate priors. This is one reason the use of
Bayesian statistics for <em>NEC</em> estimation (or even <em>ECx</em>
estimation) is not currently widely adopted across the broader
ecotoxicological community, who rarely have access to specialist
statistical expertise. The <code>bayesnec</code> package provides an
accessible interface specifically for fitting <em>NEC</em> models and
other concentration—response models using Bayesian methods. A range of
models are specified based on the known distribution of the
“concentration” or “dose” variable (the predictor) as well as the
“response” variable. The package requires a simplified model formula,
which together with the data is used to wrangle more complex non-linear
model formula(s), as well as to generate priors and initial values
required to call a <code>brms</code> model. While the distribution of
the predictor and response variables can be specified directly,
<code>bayesnec</code> will automatically attempt to assign the correct
distribution to use based on the characteristics of the provided
data.</p>
<p>This project started with an implementation of the <em>NEC</em> model
based on that described in (Pires et al. 2002) and <span class="citation">(Fox 2010)</span> using R2jags <span class="citation">(Fisher, Ricardo, and Fox 2020)</span>. The package has
been further generalised to allow a large range of response variables to
be modelled using the appropriate statistical distribution. While the
original <code>jagsNEC</code> implementation supported Gaussian-,
Poisson-, Binomial-, Gamma-, Negative Binomial- and Beta-distributed
response data, <code>bayesnec</code> additionally supports the
Beta-Binomial distribution, and can be easily extended to include any of
the available <code>brms</code> families. We have since also further
added a range of alternative <em>NEC</em> model types, as well as a
range of concentration—response models (such as 4-parameter logistic and
Weibull models) that are commonly used in frequentist-based packages
such as <code>drc</code><span class="citation">(Ritz et al.
2016)</span>. These models do not employ segmented linear regression
(i.e., use of a <code>step</code> function) but simply models the
response as a smooth function of concentration.</p>
<p>Specific models can be fit directly using <code>bnec</code>, which is
what we discuss here. Alternatively, it is possible to fit a custom
model set, a specific model set, or all the available models. Further
information on fitting multi-models using <code>bayesnec</code> can be
found in the <a href="https://open-aims.github.io/bayesnec/articles/example2.html">Multi
model usage</a> vignette. For detailed information on the models
available in <code>bayesnec</code> see the <a href="https://open-aims.github.io/bayesnec/articles/example2b.html">Model
details</a> vignette.</p>
<p>Important information on the current package is contained in the
<code>bayesnec</code> help-files and the <a href="https://open-aims.github.io/bayesnec/articles/example2b.html">Model
details</a> vignette.</p>
<p>This package is currently under development. We are keen to receive
any feedback regarding usage, and especially bug reporting that includes
an easy to run self-contained reproducible example of unexpected
behaviour, or example model fits that fail to converge (have poor chain
mixing) or yield other errors. Such information will hopefully help us
towards building a more robust package. We cannot help troubleshoot
issues if an easy-to-run reproducible example is not supplied.</p>
</div>
<div id="installation" class="section level1">
<h1>Installation</h1>
<p>To install the latest release version from CRAN use</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;bayesnec&quot;</span>)</span></code></pre></div>
<p>The current development version can be downloaded from GitHub via</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;remotes&quot;</span>)) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;remotes&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;open-aims/bayesnec&quot;</span>, <span class="at">ref =</span> <span class="st">&quot;dev&quot;</span>)</span></code></pre></div>
<p>Because <code>bayesnec</code> is based on <code>brms</code> and <a href="https://mc-stan.org/">Stan</a>, a C++ compiler is required. The
program <a href="https://cran.r-project.org/bin/windows/Rtools/">Rtools</a> comes
with a C++ compiler for Windows. On Mac, you should install Xcode. See
the prerequisites section on this <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started">link</a>
for further instructions on how to get the compilers running.</p>
<p>To run this vignette, we will also need some additional packages</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code></pre></div>
</div>
<div id="examples" class="section level1">
<h1>Examples</h1>
<div id="fitting-the-nec4param-model-using-bnec" class="section level2">
<h2>Fitting the <code>nec4param</code> model using
<code>bnec</code></h2>
<p>Here we include some examples showing how to use the package to fit
an <em>NEC</em> model to binomial, proportional, count and continuous
response data. The examples are those used at: <a href="https://github.com/gerard-ricardo/NECs/blob/master/NECs" class="uri">https://github.com/gerard-ricardo/NECs/blob/master/NECs</a>,
but here we are showing how to fit models to these data using the
<code>bayesnec</code> package. Note however, the default behaviour in
<code>bayesnec</code> is to use the <code>&quot;identity&quot;</code> link because
the native link functions for each family (e.g., <code>&quot;logit&quot;</code>
for Binomial, <code>&quot;log&quot;</code> for Poisson) introduce non-linear
transformation on formulas which are already non-linear. So please be
aware that estimates of <em>NEC</em> or <em>ECx</em> might not be as
expected when using link functions other than identity (see the <a href="https://open-aims.github.io/bayesnec/articles/example2b.html">Model
details</a> vignette for more information and the models available in
<code>bayesnec</code>).</p>
<div id="binomial-data" class="section level3">
<h3>Binomial data</h3>
<p>The response variable is considered to follow a binomial distribution
when it is a count out of a total (such as the percentage survival of
individuals, for example). First, we read in the binomial example from
<a href="https://pastebin.com/tools">pastebin</a>, prepare the data for
analysis, and then inspect the dataset as well as the “concentration”,
in this case <code>raw_x</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>binom_data <span class="ot">&lt;-</span> <span class="st">&quot;https://pastebin.com/raw/zfrUha88&quot;</span> <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.table</span>(<span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">dec =</span> <span class="st">&quot;,&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">raw_x =</span> raw.x) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">raw_x =</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(raw_x)))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(binom_data)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    48 obs. of  3 variables:</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ raw_x: num  0.1 0.1 0.1 0.1 0.1 0.1 6.25 6.25 6.25 6.25 ...</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ suc  : int  101 106 102 112 58 158 95 91 93 113 ...</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ tot  : int  175 112 103 114 69 165 109 92 99 138 ...</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(binom_data<span class="sc">$</span>raw_x)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0.10   10.94   37.50   99.23  125.00  400.00</span></span></code></pre></div>
<p>In this case for <code>raw_x</code>, lowest concentration is 0.1 and
the highest is 400. The data are right skewed and on the continuous
scale. This type of distribution for the predictor data are common for
concentration—response experiments, where the <em>concentration</em>
data are the concentration of contaminants, or dilutions. The current
default in <code>bayesnec</code> is to estimate the appropriate
distribution(s) and priors based on the data, but it is possible to
supply <code>prior</code> or <code>family</code> directly as additional
arguments to the underlying <code>brm</code> function from
<code>brms</code>. We are going to model this with the predictor data on
a log scale, as this is the scaling clearly used in the experimental
design and thus will provide more stable results.</p>
<p>The data are binomial, with the column <code>suc</code> indicating
the number of successes in the binomial call, and column
<code>tot</code> indicating the number of trials.</p>
<p>The main working function in <code>bayesnec</code> is the function
<code>bnec</code>, which calls the other necessary functions and fits
the <code>brms</code> model. We can run <code>bnec</code> by supplying
<code>formula</code>: a special formula which comprises the relationship
between response and predictor, and the C-R model (or models) chosen to
be fitted; and <code>data</code>: a <code>data.frame</code> containing
the data for the model fitting, here, <code>binom_data</code>.</p>
<p>The basic <code>bayesnec</code> formula should be of the form:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>suc <span class="sc">|</span> <span class="fu">trials</span>(tot) <span class="sc">~</span> <span class="fu">crf</span>(<span class="fu">log</span>(raw_x), <span class="at">model =</span> <span class="st">&quot;your_model&quot;</span>)</span></code></pre></div>
<p>where the left-hand side of the formula is implemented exactly as in
<code>brms</code>, including the <code>trials</code> term. The
right-hand side of the formula contains the special internal function
<code>crf</code> (which stands for concentration-response function), and
takes the predictor (including any simple function transformations such
as <code>log</code>) and the desired C-R model or suite of models. As
with any formula in R, the name of the terms need to be exactly as they
are in the input data.frame.</p>
<p><code>bnec</code> will guess the data types for use, although as
mentioned above we could manually specify <code>family</code> as
<code>&quot;binomial&quot;</code> (or <code>binomial</code>, or
<code>binomial()</code>). <code>bnec</code> will also generate
appropriate priors for the <code>brms</code> model call, although these
can also be specified manually (see the <a href="https://open-aims.github.io/bayesnec/articles/example3.html">Priors</a>
vignette for more details).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesnec)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>exp_1 <span class="ot">&lt;-</span> <span class="fu">bnec</span>(suc <span class="sc">|</span> <span class="fu">trials</span>(tot) <span class="sc">~</span> <span class="fu">crf</span>(<span class="fu">log</span>(raw_x), <span class="at">model =</span> <span class="st">&quot;nec4param&quot;</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> binom_data)</span></code></pre></div>
<p>The function shows the progress of the <code>brms</code> fit and
returns the usual <code>brms</code> output (with a few other elements
added to this list). The function <code>plot(exp_1$fit)</code> can be
used to plot the chains, so we can assess mixing and look for other
potential issues with the model fit. We can also run a pairs plot that
can help to assess issues with identifiability, and which also looks OK.
There are a range of other model diagnostics that can be explored for
<code>brms</code> model fits, using the <code>object$fit</code> syntax.
We encourage you to explore the rich material already on GitHub
regarding use and validation of <a href="https://github.com/paul-buerkner/brms">brms</a> models.</p>
<p>Initially <code>bayesnec</code> will attempt to use starting values
generated for that type of model formula and family. It will run the
iterations and then test if all chains are valid. If the model does not
have valid chains <code>bayesnec</code> will discard that model and an
error will be returned indicating the model could not be fit
successfully.</p>
<p>We can see the summary of our fitted model parameters using:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(exp_1)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Object of class bayesnecfit containing the following non-linear model: nec4param</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Family: binomial </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Links: mu = identity </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: suc | trials(tot) ~ bot + (top - bot) * exp(-exp(beta) * (log(raw_x) - nec) * step(log(raw_x) - nec)) </span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          bot ~ 1</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          top ~ 1</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          beta ~ 1</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          nec ~ 1</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Data: structure(list(raw_x = c(0.1, 0.1, 0.1, 0.1, 0.1,  (Number of observations: 48) </span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Draws: 4 chains, each with iter = 10000; warmup = 8000; thin = 1;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          total post-warmup draws = 8000</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Population-Level Effects: </span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Estimate Est.Error l-95% CI u-95% CI Rhat</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; bot_Intercept      0.05      0.02     0.02     0.08 1.00</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; top_Intercept      0.83      0.01     0.81     0.84 1.00</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta_Intercept     0.80      0.13     0.56     1.07 1.00</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; nec_Intercept      4.42      0.03     4.36     4.47 1.00</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Bulk_ESS Tail_ESS</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; bot_Intercept      3038     2860</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; top_Intercept      4443     4471</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta_Intercept     2841     3261</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; nec_Intercept      3394     4022</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bayesian R2 estimates:</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Estimate Est.Error Q2.5 Q97.5</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R2     0.81      0.00 0.80  0.82</span></span></code></pre></div>
<p>Note the Rhat values in this example are one, indicating
convergence.</p>
<p>The functions <code>plot</code> (extending <code>base</code> plot
method) and <code>autoplot</code> (extending <code>ggplot2</code> plot
method) can be used to plot the fitted model. You can also make your own
plot from the data included in the returned object (class
<code>bayesnecfit</code>) from the call to <code>bnec</code>.
<strong>Notice, however, that in this case we log-transformed the
predictor <code>raw_x</code> in the input formula.</strong> This causes
<code>brms</code> to pass these transformations onto Stan’s native code,
and therefore estimates of <em>NEC</em> will be on that same scale. So
we need to transform them back to the data scale using the additional
argument <code>xform</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(exp_1, <span class="at">xform =</span> exp)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="plot of chunk exmp1-binom" width="60%" style="display: block; margin: auto;" /></p>
<p>There are many built in methods available for <code>brmsfit</code>
objects and we encourage you to make use of these in full.</p>
<p>This model fit does not look great. You can see that the error bounds
around the fit are far too narrow for this data given the variability
among the points, suggesting over dispersion of this model (meaning that
the data are more variable than this model fit predicts). For models
whose response data are Binomial- or Poisson-distributed, an estimate of
dispersion is provided by <code>bayesnec</code>, and this can be
extracted using <code>exp_1$dispersion</code>. Values &gt; 1 indicate
overdispersion and values &lt; 1 indicate underdispersion. In this case
the overdispersion value is much bigger than 1, suggesting extreme
overdispersion (meaning our model does not properly capture the true
variability represented in this data). We would need to consider
alternative ways of modelling this data using a different distribution,
such as the Beta-Binomial.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>exp_1<span class="sc">$</span>dispersion</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimate     Q2.5    Q97.5 </span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 19.62317 13.17768 30.63329</span></span></code></pre></div>
</div>
<div id="beta-binomial" class="section level3">
<h3>Beta-Binomial</h3>
<p>The Beta-Binomial model can be useful for overdispersed Binomial
data.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>exp_1b <span class="ot">&lt;-</span> <span class="fu">bnec</span>(suc <span class="sc">|</span> <span class="fu">trials</span>(tot) <span class="sc">~</span> <span class="fu">crf</span>(<span class="fu">log</span>(raw_x), <span class="at">model =</span> <span class="st">&quot;nec4param&quot;</span>),</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> binom_data, <span class="at">family =</span> beta_binomial2)</span></code></pre></div>
<p>Fitting this data with the <code>betabinomial2</code> yields a much
more realistic fit in terms of the confidence bounds (check
<code>autoplot(exp_1b, xform = exp)</code>) and the spread in the data.
Note that a dispersion estimate is not provided here, as overdispersion
is only relevant for Poisson and Binomial data.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>exp_1b<span class="sc">$</span>dispersion</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] NA NA NA</span></span></code></pre></div>
<p>Now that we have a better fit to these data, we can interpret the
results. The estimated <em>NEC</em> value can be obtained directly from
the fitted model object. As explained above, we need to transform
<em>NEC</em> back to the data scale.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">exp</span>(exp_1b<span class="sc">$</span>nec_posterior))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   11.18   65.88   78.42   75.55   87.42  192.18</span></span></code></pre></div>
<p>EC<em>x</em> estimates can also be obtained from the <em>NEC</em>
model fit, using the function <code>ecx</code>. Note these may differ
from a typical 4-parameter non-linear model, as the <em>NEC</em> model
is a broken stick non-linear regression and will often fall more sharply
than a smooth 4-parameter non-linear curve. See both the <a href="https://open-aims.github.io/bayesnec/articles/example2b.html">Model
details</a> and <a href="https://open-aims.github.io/bayesnec/articles/example4.html">Comparing
posterior predictions</a> vignettes for more information.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ecx</span>(exp_1b, <span class="at">xform =</span> exp)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   ec_10_Q50  ec_10_Q2.5 ec_10_Q97.5 </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    82.96216    43.33243    98.57387 </span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;precision&quot;)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1000</span></span></code></pre></div>
<p>A summary method has also been developed for <code>bayesnecfit</code>
objects that gives an overall summary of the model statistics, which
also include the estimate for <em>NEC</em>, as the
<code>nec_intercept</code> population-level effect in the model—again,
its value will depend on the scale of the predictor variable.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(exp_1b)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Object of class bayesnecfit containing the following non-linear model: nec4param</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Family: beta_binomial2 </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Links: mu = identity; phi = identity </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: suc | trials(tot) ~ bot + (top - bot) * exp(-exp(beta) * (log(raw_x) - nec) * step(log(raw_x) - nec)) </span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          bot ~ 1</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          top ~ 1</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          beta ~ 1</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          nec ~ 1</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Data: structure(list(raw_x = c(0.1, 0.1, 0.1, 0.1, 0.1,  (Number of observations: 48) </span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Draws: 4 chains, each with iter = 10000; warmup = 8000; thin = 1;</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          total post-warmup draws = 8000</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Population-Level Effects: </span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Estimate Est.Error l-95% CI u-95% CI Rhat</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; bot_Intercept      0.13      0.05     0.03     0.23 1.00</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; top_Intercept      0.84      0.03     0.77     0.88 1.00</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta_Intercept     0.82      0.65    -0.19     2.75 1.00</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; nec_Intercept      4.36      0.19     3.65     4.58 1.00</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Bulk_ESS Tail_ESS</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; bot_Intercept      2591     2775</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; top_Intercept      2476     3116</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta_Intercept     1187     1040</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; nec_Intercept      1139      982</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Family Specific Parameters: </span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; phi     5.31      1.24     3.22     8.16 1.00     2175</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     Tail_ESS</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; phi     3565</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bayesian R2 estimates:</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Estimate Est.Error Q2.5 Q97.5</span></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R2     0.76      0.04 0.67  0.81</span></span></code></pre></div>
</div>
<div id="beta-data" class="section level3">
<h3>Beta data</h3>
<p>Sometimes the response variable is distributed between <code>0</code>
and <code>1</code> but is not a straight-forward Binomial because it is
a proportion on the continuous scale. A common example in coral ecology
is maximum quantum yield (the proportion of light used for
photosynthesis when all reaction centres are open) which is a measure of
photosynthetic efficiency calculated from Pulse-Amplitude-Modulation
(PAM) data. Here we have a proportion value that is not based on trials
and successes. In this case there are no theoretical trials, and the
data must be modelled using a Beta distribution instead.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>prop_data <span class="ot">&lt;-</span> <span class="st">&quot;https://pastebin.com/raw/123jq46d&quot;</span> <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.table</span>(<span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">dec =</span> <span class="st">&quot;,&quot;</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">raw_x =</span> raw.x) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), as.numeric))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>exp_2 <span class="ot">&lt;-</span> <span class="fu">bnec</span>(resp <span class="sc">~</span> <span class="fu">crf</span>(<span class="fu">log</span>(raw_x <span class="sc">+</span> <span class="dv">1</span>), <span class="at">model =</span> <span class="st">&quot;nec4param&quot;</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> prop_data)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(exp_2, <span class="at">xform =</span> <span class="cf">function</span>(x)<span class="fu">exp</span>(x) <span class="sc">-</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="plot of chunk exmp1-beta" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="poisson-data" class="section level3">
<h3>Poisson data</h3>
<p>Where data are a count (of, for example, individuals or cells), the
response is likely to be Poisson distributed. Such data are distributed
from <code>0</code> to <code>Inf</code> and are integers. First we mimic
count data based on the package’s internal dataset, and make it
overdispersed. Then we plot the concentration (i.e. predictor) data.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(nec_data)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">330</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>count_data <span class="ot">&lt;-</span> nec_data <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> (y <span class="sc">*</span> <span class="dv">100</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(nec_data), <span class="dv">0</span>, <span class="dv">15</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>      round <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>      as.integer <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>      abs</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(count_data)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &#39;data.frame&#39;:    100 obs. of  2 variables:</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ x: num  1.019 0.816 0.371 0.401 1.295 ...</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  $ y: int  109 116 88 101 95 89 66 78 101 80 ...</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(count_data<span class="sc">$</span>y)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    5.00   68.00   84.00   76.87   92.25  124.00</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(count_data<span class="sc">$</span>x)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.03235 0.43424 0.87599 1.05142 1.59336 3.22052</span></span></code></pre></div>
<p>First, we supply <code>bnec</code> with <code>data</code> (here
<code>count_data</code>), and specify our formula. As we have integers
of 0 and greater, the <code>family</code> is <code>&quot;poisson&quot;</code>. The
default behaviour to guess the variable types works for this
example.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">333</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>exp_3 <span class="ot">&lt;-</span> <span class="fu">bnec</span>(y <span class="sc">~</span> <span class="fu">crf</span>(x, <span class="at">model =</span> <span class="st">&quot;nec4param&quot;</span>), <span class="at">data =</span> count_data)</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(exp_3)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="plot of chunk exmp1-poisson" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>exp_3<span class="sc">$</span>dispersion</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Estimate       Q2.5      Q97.5 </span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  2.1059688  0.1887641 64.4594877</span></span></code></pre></div>
<p>We first plot the model chains (with <code>plot(exp_3$fit)</code>)
and parameter estimates to check the fit. The chains look OK. However,
our plot of the fit is not very convincing. The model uncertainty is
very narrow, and this does not seem to be a particularly good model for
these data. Note that the dispersion estimate is much greater than one,
indicating serious overdispersion. In this case we can try to refit the
model but instead deliberately specifying the Negative Binomial
distribution for via the <code>family</code> argument.</p>
</div>
<div id="negative-binomial" class="section level3">
<h3>Negative binomial</h3>
<p>When count data are overdispersed and cannot be modelled using the
Poisson distribution, the Negative binomial distribution is generally
used. We can do this by calling <code>family = &quot;negbinomial&quot;</code>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>exp_3b <span class="ot">&lt;-</span> <span class="fu">bnec</span>(y <span class="sc">~</span> <span class="fu">crf</span>(x, <span class="at">model =</span> <span class="st">&quot;nec4param&quot;</span>), <span class="at">data =</span> count_data,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="st">&quot;negbinomial&quot;</span>)</span></code></pre></div>
<p>The resultant plot seems to indicate the Negative Binomial
distribution works better in terms of dispersion (more sensible wider
confidence bands), however it still might not be the best model for
these data. See the <a href="https://open-aims.github.io/bayesnec/articles/example2b.html">Model
details</a> and <a href="https://open-aims.github.io/bayesnec/articles/example2.html">Multi
model usage</a> vignettes for options to fit other models to these
data.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(exp_3b)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="plot of chunk exmp1-negbinbase" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="measure-data" class="section level3">
<h3>Measure data</h3>
<p>Where data are a measured variable, the response is likely to be
Gamma distributed. Good examples of <code>Gamma</code>-distributed data
include measures of body size, such as length, weight, or area. Such
data are distributed from <code>0+</code> to <code>Inf</code> and are
continuous. Here we use the <code>nec_data</code> supplied with
<code>bayesnec</code> with the response <code>y</code> on the
exponential scale to ensure the right data range for a Gamma as an
example.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(nec_data)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>measure_data <span class="ot">&lt;-</span> nec_data <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">measure =</span> <span class="fu">exp</span>(y))</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>exp_4 <span class="ot">&lt;-</span> <span class="fu">bnec</span>(measure <span class="sc">~</span> <span class="fu">crf</span>(x, <span class="at">model =</span> <span class="st">&quot;nec4param&quot;</span>), <span class="at">data =</span> measure_data)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(exp_4)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="plot of chunk exmp1-gammabase" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(exp_4)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Object of class bayesnecfit containing the following non-linear model: nec4param</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Family: gamma </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Links: mu = identity; shape = identity </span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Formula: measure ~ bot + (top - bot) * exp(-exp(beta) * (x - nec) * step(x - nec)) </span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          bot ~ 1</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          top ~ 1</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          beta ~ 1</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          nec ~ 1</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Data: structure(list(x = c(1.01874617094183, 0.815747457 (Number of observations: 100) </span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Draws: 4 chains, each with iter = 10000; warmup = 8000; thin = 1;</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          total post-warmup draws = 8000</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Population-Level Effects: </span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Estimate Est.Error l-95% CI u-95% CI Rhat</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; bot_Intercept      0.98      0.05     0.88     1.07 1.00</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; top_Intercept      2.44      0.01     2.41     2.46 1.00</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta_Intercept     0.65      0.10     0.46     0.84 1.00</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; nec_Intercept      1.50      0.02     1.46     1.54 1.00</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Bulk_ESS Tail_ESS</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; bot_Intercept      3199     4023</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; top_Intercept      5893     5156</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; beta_Intercept     2739     3589</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; nec_Intercept      3561     4345</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Family Specific Parameters: </span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; shape   516.25     73.26   383.20   675.06 1.00     5829</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Tail_ESS</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; shape     5073</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Bayesian R2 estimates:</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Estimate Est.Error Q2.5 Q97.5</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; R2     0.95      0.00 0.94  0.95</span></span></code></pre></div>
<p>In this case our model has converged really well.</p>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Burkner2017" class="csl-entry">
Bürkner, Paul Christian. 2017. <span>“<span class="nocase">brms: An R
package for Bayesian multilevel models using Stan</span>.”</span>
<em>Journal of Statistical Software</em> 80 (1): 1–28. <a href="https://doi.org/10.18637/jss.v080.i01">https://doi.org/10.18637/jss.v080.i01</a>.
</div>
<div id="ref-Burkner2018" class="csl-entry">
Bürkner, Paul-Christian. 2018. <span>“Advanced <span>Bayesian</span>
Multilevel Modeling with the <span>R</span> Package <span class="nocase">brms</span>.”</span> <em>The R Journal</em> 10 (1):
395–411. <a href="https://doi.org/10.32614/RJ-2018-017">https://doi.org/10.32614/RJ-2018-017</a>.
</div>
<div id="ref-Fisher2020" class="csl-entry">
Fisher, Rebecca, Gerard Ricardo, and David Fox. 2020. <span>“<span class="nocase">Bayesian concentration-response modelling using
jagsNEC</span>.”</span> <a href="https://doi.org/10.5281/ZENODO.3966864">https://doi.org/10.5281/ZENODO.3966864</a>.
</div>
<div id="ref-Fox2010" class="csl-entry">
Fox, David R. 2010. <span>“<span class="nocase">A Bayesian approach for
determining the no effect concentration and hazardous concentration in
ecotoxicology</span>.”</span> <em>Ecotoxicology and Environmental
Safety</em> 73 (2): 123–31.
</div>
<div id="ref-Plummer2003" class="csl-entry">
Plummer, Martyn. 2003. <span>“<span class="nocase">JAGS: A program for
analysis of Bayesian graphical models using Gibbs
sampling</span>.”</span> In <em><span class="nocase">Proceedings of the
3rd International Workshop on Distributed Statistical Computing (DSC
2003)</span></em>, 1–10. Technische Universität Wien, Vienna, Austria:
Achim Zeileis.
</div>
<div id="ref-Ritz2016" class="csl-entry">
Ritz, Christian, Florent Baty, Jens C Streibig, and Daniel Gerhard.
2016. <span>“<span>Dose-Response Analysis Using R</span>.”</span>
<em>PLoS ONE</em> 10 (12): e0146021. <a href="https://doi.org/10.1371/journal.pone.0146021">https://doi.org/10.1371/journal.pone.0146021</a>.
</div>
<div id="ref-Su2015" class="csl-entry">
Su, Yu-Sung, and Masanao Yajima. 2015. <em><span class="nocase">R2jags:
Using R to Run ’JAGS’</span></em>. <a href="https://CRAN.R-project.org/package=R2jags">https://CRAN.R-project.org/package=R2jags</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
